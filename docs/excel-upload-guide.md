# 통합 엑셀 업로드 기능 사용 가이드

## 개요
전형/단위/편제 데이터를 하나의 엑셀 파일에 여러 시트로 구성하여 한 번에 업로드할 수 있는 기능입니다.

## 지원하는 데이터 타입

### 1. 전형 데이터
**감지 키워드**: 전형명, 전형코드, 전형 코드, 전형코 드

**필수 컬럼**:
- 전형코드 (2자리 숫자)
- 전형명

**예시**:
| 전형코드 | 전형명 |
|---------|--------|
| 01 | 수시 |
| 02 | 정시 |

### 2. 단위 데이터
**감지 키워드**: 단위명, 단위코드, 단위 코드, 단위코 드

**필수 컬럼**:
- 단위코드 (2자리 숫자)
- 단위명

**예시**:
| 단위코드 | 단위명 |
|---------|--------|
| 01 | 인문계열 |
| 02 | 자연계열 |

### 3. 편제 데이터
**감지 키워드**: 편제명, 과목코드, 과목명, 교과코드, 과목 코드, 교과 코드

**필수 컬럼**:
- 편제명
- 과목코드
- 과목명
- 교과코드 (3자리 숫자)

**예시**:
| 편제명 | 과목코드 | 과목명 | 교과코드 |
|--------|----------|--------|----------|
| 공통과목 | KOR001 | 국어 | 101 |
| 공통과목 | MAT001 | 수학 | 102 |

## 사용 방법

### 1. 미리보기 기능
1. "미리보기" 버튼 클릭
2. 엑셀 파일 선택
3. 각 시트가 어떤 타입으로 감지되는지 확인
4. 샘플 데이터와 컬럼 정보 확인

### 2. 통합 업로드 기능
1. "통합 업로드" 버튼 클릭
2. 엑셀 파일 선택
3. 자동으로 시트 타입을 감지하여 업로드
4. 업로드 결과 확인

### 3. 개별 업로드 기능 (기존)
1. 원하는 탭 선택 (전형/단위/편제)
2. "개별 업로드" 버튼 클릭
3. 해당 타입의 데이터만 포함된 엑셀 파일 선택

## 엑셀 파일 구성 예시

### 파일명: university_data.xlsx

**시트1: 전형정보**
| 전형코드 | 전형명 | 비고 |
|---------|--------|------|
| 01 | 수시 | 학생부종합 |
| 02 | 정시 | 수능 |

**시트2: 단위정보**
| 단위코드 | 단위명 | 설명 |
|---------|--------|------|
| 01 | 인문계열 | 인문학 관련 |
| 02 | 자연계열 | 이공계 관련 |

**시트3: 편제정보**
| 편제명 | 과목코드 | 과목명 | 교과코드 |
|--------|----------|--------|----------|
| 공통과목 | KOR001 | 국어 | 101 |
| 공통과목 | MAT001 | 수학 | 102 |
| 공통과목 | ENG001 | 영어 | 103 |

## 주의사항

1. **코드 형식**:
   - 전형코드, 단위코드: 정확히 2자리 (예: 01, 02)
   - 교과코드: 정확히 3자리 (예: 101, 102)

2. **헤더 컬럼**:
   - 공백이 포함된 컬럼명도 자동으로 정규화됩니다
   - 대소문자를 구분하지 않습니다

3. **데이터 검증**:
   - 필수 컬럼이 없는 행은 자동으로 제외됩니다
   - 빈 행이나 헤더만 있는 시트는 무시됩니다

4. **업로드 결과**:
   - 각 타입별로 처리된 건수와 시트명을 확인할 수 있습니다
   - 처리되지 않은 시트가 있다면 목록을 확인할 수 있습니다

## 문제 해결

### 시트가 감지되지 않는 경우
1. 헤더 컬럼에 키워드가 포함되어 있는지 확인
2. 컬럼명에 오타가 없는지 확인
3. 시트에 데이터가 있는지 확인

### 업로드 실패 시
1. 필수 컬럼이 모두 있는지 확인
2. 코드 형식이 올바른지 확인
3. 데이터에 빈 값이 없는지 확인
